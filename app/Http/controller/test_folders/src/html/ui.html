<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h1>SQL Generator</h1>
    <form>
      <label for="question">Enter your question:</label>
      <input type="text" id="question" name="question">
      <button type="submit">Generate SQL</button>
    </form>
    <div id="result"></div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        document.querySelector('form').addEventListener('submit', function(e) {
            e.preventDefault();
            var question = document.querySelector('#question').value;
            google.script.run.withSuccessHandler(showResult).generateSQL(question);
          });
        });
      });
      
      function showResult(data) {
        var resultDiv = document.querySelector('#result');
        resultDiv.innerHTML = '';
        var table = document.createElement('table');
        table.border = '1';
        var headerRow = table.insertRow(0);
        headerRow.insertCell(0).innerHTML = 'SQL';
        headerRow.insertCell(1).innerHTML = 'Result';
        var sqlRow = table.insertRow(1);
        sqlRow.insertCell(0).innerHTML = data.sql;
        var resultTable = document.createElement('table');
        resultTable.border = '1';
        var headerRow = resultTable.insertRow(0);
        for (var i = 0; i < data.result[0].length; i++) {
          headerRow.insertCell(i).innerHTML = Object.keys(data.result[0])[i];
        }
        for (var i = 0; i < data.result.length; i++) {
          var row = resultTable.insertRow(i + 1);
          for (var j = 0; j < data.result[i].length; j++) {
            row.insertCell(j).innerHTML = data.result[i][j];
          }
        }
        sqlRow.insertCell(1).appendChild(resultTable);
        resultDiv.appendChild(table);
      }
    </script>
  </body>
</html>